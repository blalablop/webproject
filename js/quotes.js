let _foodQuotesCache=null;const QUOTES_URL="https://type.fit/api/quotes";const _fallbackFoodQuotes=[{text:"People who love to eat are always the best people.",author:"Julia Child"},{text:"One cannot think well, love well, sleep well, if one has not dined well.",author:"Virginia Woolf"},{text:"Cooking is at once child's play and adult joy.",author:"Craig Claiborne"},{text:"You don't need a silver fork to eat good food.",author:"Paul Prudhomme"},{text:"Laughter is brightest in the place where food is.",author:"Irish Proverb"},{text:"A recipe has no soul. You, as the cook, must bring soul to the recipe.",author:"Thomas Keller"},{text:"First we eat, then we do everything else.",author:"M.F.K. Fisher"}];const _foodRegex=/(food|eat|eating|meal|cook|cooking|kitchen|restaurant|taste|recipe|chef)/i;function pickRandom(arr){return arr[Math.floor(Math.random()*arr.length)]}function withTimeout(promise,ms){const c=new AbortController;const t=setTimeout(()=>c.abort(),ms);return fetch(QUOTES_URL,{signal:c.signal,cache:"no-store",mode:"cors"}).finally(()=>clearTimeout(t))}async function fetchOnlineFiltered(){try{const r=await withTimeout(fetch(QUOTES_URL),4000);if(!r||!r.ok)return null;const data=await r.json();const filtered=(Array.isArray(data)?data:[]).filter(q=>q&&q.text&&_foodRegex.test(q.text));return filtered.length?filtered:null}catch(e){return null}}async function loadFoodQuotes(preferOnline=false){if(preferOnline){const online=await fetchOnlineFiltered();if(online){_foodQuotesCache=online;return online}}if(_foodQuotesCache)return _foodQuotesCache;const online=await fetchOnlineFiltered();if(online){_foodQuotesCache=online;return online}_foodQuotesCache=_fallbackFoodQuotes;return _foodQuotesCache}function setStatus(isOnline){const au=document.getElementById("food-quote-author");if(!au)return;const txt=au.textContent.replace(/\s*\(online\)|\s*\(offline\)/i,"");au.textContent=txt+` ${isOnline?"(online)":"(offline)"}`}async function renderFoodQuote(preferOnline=false){const el=document.getElementById("food-quote");const au=document.getElementById("food-quote-author");if(!el||!au)return;setStatus(navigator.onLine);const quotes=await loadFoodQuotes(preferOnline&&navigator.onLine);const q=pickRandom(quotes);el.textContent=`“${q.text}”`;au.textContent=(q.author?`— ${q.author}`:"— Unknown")+` ${navigator.onLine?"(online)":"(offline)"}`}document.addEventListener("DOMContentLoaded",function(){const btn=document.getElementById("refresh-quote");if(btn)btn.addEventListener("click",()=>renderFoodQuote(true));window.addEventListener("online",()=>{_foodQuotesCache=null;renderFoodQuote(true)});window.addEventListener("offline",()=>setStatus(false));renderFoodQuote(true)});